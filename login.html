<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Login - Tile-it</title>
<link rel="stylesheet" href="styles/theme.css">
<style>
  *{ box-sizing:border-box }
  body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background-color:var(--bg); background-image:var(--grid-bg); color:var(--text); display:flex; align-items:center; justify-content:center; height:100vh; }
  .card{ background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:20px; max-width:400px; width:100%; }
  .card h2{ margin:0 0 12px 0; }
  form{ display:flex; flex-direction:column; gap:8px; margin-bottom:16px; }
  input[type="email"], input[type="password"]{ padding:8px; border-radius:10px; border:1px solid var(--border); background:var(--bg); color:var(--text); }
  .btn{ background:var(--accent); color:var(--bg); border:none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600; }
  .btn.secondary{ background:var(--panel); border:1px solid var(--border); color:var(--text); }
</style>
</head>
<body>
  <div class="card">
    <h2>Sign In</h2>
    <form id="signin-form">
      <input type="email" id="signin-email" placeholder="Email" required />
      <input type="password" id="signin-password" placeholder="Password" required />
      <button type="submit" class="btn">Sign In</button>
    </form>
    <h2>Sign Up</h2>
    <form id="signup-form">
      <input type="email" id="signup-email" placeholder="Email" required />
      <input type="password" id="signup-password" placeholder="Password" required />
      <button type="submit" class="btn secondary">Sign Up</button>
    </form>
  </div>
<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';
const supabaseUrl = 'https://bpwlgiiksovtccsrojko.supabase.co';
const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwd2xnaWlrc292dGNjc3JvamtvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3MDc1NzIsImV4cCI6MjA3MjI4MzU3Mn0.Vrq9hTdWnGH0E6WQ0HvR_J8k7qax96FqkurJcr7VQkk';
const supabase = createClient(supabaseUrl, supabaseAnonKey);

async function redirectIfLoggedIn(){
  const { data } = await supabase.auth.getSession();
  if (data.session) window.location.href = 'index.html';
}
redirectIfLoggedIn();

document.getElementById('signin-form').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const email = document.getElementById('signin-email').value;
  const password = document.getElementById('signin-password').value;
  const { error } = await supabase.auth.signInWithPassword({ email, password });
  if(error){ alert(error.message); return; }
  window.location.href = 'index.html';
});

document.getElementById('signup-form').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const email = document.getElementById('signup-email').value;
  const password = document.getElementById('signup-password').value;
  const { error } = await supabase.auth.signUp({ email, password });
  if(error){ alert(error.message); return; }
  window.location.href = 'index.html';
});

const savedTheme = localStorage.getItem('theme');
if(savedTheme === 'light'){
  document.body.classList.add('light-mode');
}
</script>
</body>
</html>
